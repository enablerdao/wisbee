# Ollama LLM ベンチマークツール

Ollama言語モデルの性能測定とQ&A評価を行うツールキットです。

## 概要

このプロジェクトは、Ollamaで動作する各種言語モデルの性能を多角的に評価するための統合ベンチマークツールです。

### 主要コンポーネント

- **obench.sh** - シンプルな性能測定（トークン/秒）
- **obench2.sh** - 包括的なQ&A評価（GPT-4採点オプション付き）
- **questions.txt** - 15問の日本語評価問題セット

## インストール

```bash
# 依存関係のインストール
brew install jq bc

# Ollamaのインストール（未インストールの場合）
brew install ollama
```

## 使用方法

### 性能ベンチマーク

```bash
# デフォルトモデルをテスト
./obench.sh

# 特定モデルをテスト
./obench.sh gemma2:2b llama3:latest

# カスタムトークン上限でテスト
./obench.sh --max-tok 2048
```

### Q&A評価

```bash
# GPT-4採点付きQ&A評価
export OPENAI_API_KEY="your-key-here"
./obench2.sh

# 採点なしで実行
./obench2.sh --no-score

# 特定モデルをカスタムトークン上限でテスト
./obench2.sh gemma3:1b qwen3:latest --max-tok 128
```

## ベンチマーク結果（2025年6月6日）

### モデル評価サマリー

| モデル | サイズ | 総合評価 | 速度 | 精度 | 日本語 | 特徴 |
|--------|--------|----------|------|------|---------|------|
| **gemma3:4b** | 3.3GB | ⭐⭐⭐⭐ | 中速 | 高 | 良好 | バランス最良 |
| **qwen3:latest** | 5.2GB | ⭐⭐⭐⭐ | 遅い | 高 | 優秀 | 思考プロセス付き |
| **phi3:mini** | 2.2GB | ⭐⭐⭐ | 高速 | 中 | 可 | コスパ良好 |
| **llama3.2:1b** | 1.3GB | ⭐⭐ | 高速 | 低 | 可 | 軽量・高速 |
| **qwen3:1.7b** | 1.4GB | ⭐⭐⭐ | 中速 | 中 | 良好 | 小型で高性能 |
| **gemma3:1b** | 815MB | ⭐⭐ | 高速 | 低 | 可 | 超軽量 |
| **llava:7b** | 4.7GB | ⭐⭐ | 極遅 | 低 | 不可 | 画像特化型 |
| **jaahas/qwen3-abliterated:0.6b** | 396MB | ⭐ | 高速 | 極低 | 不可 | 実用性低い |

### トークン上限別推奨設定

- **7bクラス（llava:7b等）**: 最大2000トークン推奨
- **1.7b以下クラス**: 最大3000トークン推奨
- **中型モデル（4b前後）**: デフォルト256トークンで十分

## テスト結果の詳細

### 実施テスト一覧

1. **基本性能テスト** - トークン生成速度の測定
2. **高度な問題解決** - 論理・数学・プログラミング
3. **会話継続性** - 文脈保持能力
4. **コーディング能力** - 実装タスク
5. **創造的思考** - ストーリー生成・アイデア出し
6. **日本語理解** - 日本文化・言語特有の理解度

### ログファイル

評価結果は`~/oeval_logs/`にJSONL形式で保存されます。

## プロジェクト構成

```
bench-llm/
├── obench.sh              # 性能ベンチマーク
├── obench2.sh             # Q&A評価ツール
├── questions.txt          # 評価用質問セット
├── CLAUDE.md              # プロジェクト指示書
├── config.json            # 設定ファイル
└── ollama-chat-ui/        # チャットUIアプリ
    ├── wisbee-ios/        # iOSアプリ
    └── standalone/        # スタンドアロン版
```

## 追加ツール

- **ollama-code-cli/** - CLIベースのコード支援ツール
- **wisbee-ios/** - iOS向けチャットアプリ
- **wisbee-mac/** - macOS向けElectronアプリ

## ベンチマーク結論

### 🏆 総合ベスト
- **gemma3:4b** - バランス最良（速度・精度・日本語）
- **qwen3:latest** - 精度最高、思考プロセス付き（速度は遅め）

### 💨 軽量高速部門
- **phi3:mini** - 2.2GBでコスパ最高
- **llama3.2:1b** - 1.3GBで超高速（精度は低め）

### ❌ 非推奨
- **llava:7b** - 極端に遅い、画像特化型
- **jaahas/qwen3-abliterated:0.6b** - 精度が実用レベル以下

### 📝 使い分けガイド
- **高精度が必要**: qwen3:latest または gemma3:4b
- **速度重視**: phi3:mini または llama3.2:1b
- **日本語重視**: qwen3系列
- **バランス重視**: gemma3:4b

## 🎙️ リアルタイム音声チャット機能

### 概要
音声入力・音声出力に対応したリアルタイムチャットインターフェースを実装しました。

### 機能
- **リアルタイム音声認識**: Web Speech APIによる高速な音声認識
- **自然な音声合成**: Edge TTSとgTTSによる高品質な音声出力
- **ストリーミング応答**: AIの応答を逐次的に音声化
- **連続会話モード**: ハンズフリーでの対話が可能
- **ビジュアルフィードバック**: 音声レベルメーターとアニメーション

### 使用方法

```bash
# 依存関係のインストール
pip3 install -r requirements-voice.txt

# 音声チャットの起動
./start-voice-chat.sh
```

ブラウザで `http://localhost:8890/realtime-voice-chat.html` を開きます。

### 対応音声
- 日本語: ななみ（女性）、けいた（男性）
- 英語: Jenny（女性）、Guy（男性）

## 今後の予定

- Whisper WebAssemblyによる高精度音声認識の統合
- より詳細なベンチマーク指標の追加
- マルチモーダル評価の強化

## ライセンス

このプロジェクトはMITライセンスで公開されています。